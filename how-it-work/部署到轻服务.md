### 手摸手带你将代码部署到轻服务

> 由于字节跳动轻服务注册功能维护, 目前可采用腾讯云云函数暂时代替执行.

轻服务是什么?

> 轻服务提供开箱即用的云服务和多终端可用的 Web IDE，让开发者无需关心服务器搭建、数据库部署、环境配置和线上运维等繁琐之事，只需专注于产品开发本身.

结论: 非常好用, 还免费! 借助轻服务我们可以实现图片上传, 邮箱服务等

#### 下载与安装

- 安装Node.JS(需要自行搜索安装)
- 克隆项目 或 单击绿色`Code`按钮, 选择`Download ZIP`
- 进入项目文件夹中`src`目录, 安装全部依赖, 执行命令
  
  ```shell
  npm i
  ```

#### 将代码部署到轻服务

1. 访问[https://qingfuwu.cn/](https://qingfuwu.cn/) , 注册帐号并完成新手引导
2. 点击创建服务, 输入服务名称(例如: `autolockin`), 其他参数不改动, 点击确定
3. 进入服务后找到左下角的NPM依赖, 点击搜索框依次输入`jsdom`, `node-fetch`,`nodemailer`, 并单击安装
4. 进入服务后点击左侧'设置', 找到基本信息-Service ID-赋值六位ID
   1. 使用Service ID替换: `src/config.js`中66行的`xxxxxx`
   2. 使用Service ID替换: `src/qingfuwu/functionDeploy.js`中28与45行的`xxxxxx`
   3. 使用Service ID替换: `src/qingfuwu/page/index.html`中11行的`xxxxxx`
5. 在轻服务站点右上角单击个人头像, 选择'设置', 单击左侧'个人访问凭证', 单击'生成新的凭证', 输入凭证名称(例如: `autolockin`), 单击权限范围中的'全局', 单击创建凭证, 在页面上方找到个人凭证旁的复制按钮复制凭证. 将凭证粘贴并替换`src/qingfuwu/functionDeploy.js`的32与49行中的 `icp_xx...`
6. 打开`config.js`
   1. 将第2行`local`替换为`qingfuwu`
   2. 在5, 6行输入学号密码
   3. 将47行修改为`methods: 'qingfuwu',`
   4. 在67行设置一个图片上传下载密码
   5. 修改79行为`enable: true,`
   6. 修改80行为`qingMid: true,`
   7. 修改81行为`restImg: true,`
   8. 修改82行中邮箱为您接收打卡结果的邮箱
   9. [可选], 如果您想使用自己的邮箱发送打卡结果, 请按照指引填写83-85行
7. 打开`src/qingfuwu/functionDeploy.js`
   1. 执行代码

      ```node
      node functionDeploy.js
      ```

   2. 在云函数首页点击'上线'-'上线所有'

#### 使用轻服务定时执行实现打卡

1. 设置健康打卡
   1. 转到我们创建的轻服务
   2. 选择左侧定时任务
   3. 选择创建定时任务
   4. 起一个名字名
   5. 配置执行时间
   6. 设置每天执行
   7. 选择执行函数`morning.js`
2. 创建查寝任务
   1. 转到我们创建的轻服务
   2. 选择左侧定时任务
   3. 选择创建定时任务
   4. 起一个名字名
   5. 配置执行时间
   6. 设置每天执行
   7. 选择执行函数`evening.js`


#### 使用轻服务实现打卡结果邮件通知

1. 转到我们创建的服务
2. 选择左侧小中间件
3. 点击浏览所有
4. 搜索'auto_clock_in_szxd'
5. 点击安装, 并选择我们的服务

#### 使用轻服务实现图片预上传, 并在打卡后销毁

1. 转到我们创建的服务
2. 选择左侧'设置'
3. 打开开启客户端文件上传开关
4. 复制开关下方的文件上传token, 粘贴到`src/qingfuwu/page/index.html`
5. 转到轻服务页面左侧'页面托管'
6. 压缩`src/qingfuwu/page/index.html`并上传
7. 选择网站类型: SPA单页应用
8. 选择入口文件: `index.html`
9. 配置一个喜欢的网站域名(默认就行)
10. 为网站起名
11. 在浏览器中打开网站域名即可上传文件

> 如果您认为这个项目对您有帮助, 欢迎在右上角给我一个🌟
